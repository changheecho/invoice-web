{
  "tasks": [
    {
      "id": "d1593e1a-a176-4f39-9ca7-6a1a9ad77adf",
      "name": "Task A-1: API routes에 ISR 캐싱 옵션 추가",
      "description": "src/app/api/notion/invoices/route.ts와 src/app/api/notion/invoice/[id]/route.ts에 next: { revalidate: 60 } 옵션 추가로 60초 캐싱 구현. Vercel에서 X-Vercel-Cache: HIT 헤더 확인 가능.\\n\\n수정 파일:\\n- src/app/api/notion/invoices/route.ts (라인 67 근처 fetch 호출)\\n- src/app/api/notion/invoice/[id]/route.ts (동일 패턴)\\n\\n구현 방식:\\n```\\nconst response = await fetch(url, {\\n  method: 'POST',\\n  headers: {...},\\n  body: JSON.stringify({...}),\\n  next: { revalidate: 60 }\\n})\\n```\\n\\n검증:\\n- curl로 동일 요청 2회 실행\\n- 서버 로그에서 Notion API 호출 1회만 확인\\n- 같은 URL 재방문 시 캐시 히트 확인",
      "notes": "- revalidate: 60은 60초마다 백그라운드에서 재검증\\n- 관리자용 API는 60초, 공개 페이지는 300초 고려\\n- cache: 'no-store'가 있으면 제거할 것",
      "status": "pending",
      "dependencies": [],
      "createdAt": "2026-02-21T02:29:05.218Z",
      "updatedAt": "2026-02-21T02:29:05.218Z",
      "relatedFiles": [
        {
          "path": "src/app/api/notion/invoices/route.ts",
          "type": "TO_MODIFY",
          "description": "fetch() 호출에 next: { revalidate: 60 } 추가",
          "lineStart": 67,
          "lineEnd": 85
        },
        {
          "path": "src/app/api/notion/invoice/[id]/route.ts",
          "type": "TO_MODIFY",
          "description": "fetch() 호출에 next: { revalidate: 60 } 추가"
        },
        {
          "path": "src/app/dashboard/page.ts",
          "type": "REFERENCE",
          "description": "API를 호출하는 consumer 페이지"
        }
      ],
      "implementationGuide": "1. 각 API route의 fetch() 호출을 찾기\\n2. fetch 호출의 두 번째 인자(options object)에 next: { revalidate: 60 } 추가\\n3. 기존 headers, body, method 등은 유지\\n4. 변경 후 npm run dev로 확인\\n5. curl을 사용해 동일 요청 2회 실행:\\n   curl http://localhost:3000/api/notion/invoices\\n6. 콘솔 로그에서 '[API] Notion 데이터베이스 조회' 메시지 1회만 출력되는지 확인",
      "verificationCriteria": "1. 변경된 API routes의 fetch() 호출에 next: { revalidate: 60 } 옵션 확인\\n2. npm run dev 후 curl로 동일 URL 2회 요청\\n3. 서버 로그에서 'Notion 데이터베이스 조회' 메시지 1회만 출력\\n4. 60초 이내 재요청 시 캐시 응답 확인\\n5. 기존 기능(데이터 조회, 인증) 정상 작동 검증",
      "analysisResult": "Phase 1: 견적서 상세 조회 성능 최적화 (ROADMAP.md 기준)\\\\n\\\\n목표: Lighthouse Performance 74→90+, Notion API 호출 60% 감소, 체감 로딩시간 1초 이내\\\\n\\\\n현황: API 캐싱 부재, 스켈레톤 UI 부분적 구현, Suspense 구조 미흡\\\\n\\\\n전략:\\\\n- ISR 캐싱으로 Notion API 호출 감소\\\\n- 스켈레톤 세분화로 로딩 체감 개선\\\\n- Suspense 경계 최적화\\\\n\\\\n기간: 3일 (2026-02-24 ~ 2026-02-26)"
    },
    {
      "id": "f81c4626-2e18-47e9-b53d-5da44adfe8e5",
      "name": "Task A-2: 공개 견적서 페이지 fetch 캐싱",
      "description": "src/app/invoice/[shareId]/page.tsx의 generateMetadata 함수 내 fetch() 호출에 next: { revalidate: 300 } 추가. 공개 페이지는 수정 빈도가 낮으므로 300초로 설정.\\n\\n수정 파일:\\n- src/app/invoice/[shareId]/page.tsx (라인 38 근처 generateMetadata 내 fetch)\\n\\n구현:\\n```\\nconst response = await fetch(url, {\\n  headers: {...},\\n  next: { revalidate: 300 }\\n})\\n```",
      "notes": "- 공개 페이지는 관리자가 공유한 후 자주 수정되지 않음\\n- 300초(5분)는 적절한 균형\\n- 추후 필요시 환경 변수로 조정 가능",
      "status": "pending",
      "dependencies": [
        {
          "taskId": "d1593e1a-a176-4f39-9ca7-6a1a9ad77adf"
        }
      ],
      "createdAt": "2026-02-21T02:29:05.218Z",
      "updatedAt": "2026-02-21T02:29:05.218Z",
      "relatedFiles": [
        {
          "path": "src/app/invoice/[shareId]/page.tsx",
          "type": "TO_MODIFY",
          "description": "generateMetadata 내 fetch에 next: { revalidate: 300 } 추가",
          "lineStart": 38,
          "lineEnd": 44
        }
      ],
      "implementationGuide": "1. generateMetadata 함수에서 fetch() 호출 찾기 (라인 38)\\n2. fetch의 options object에 next: { revalidate: 300 } 추가\\n3. 300초 = 5분으로, 공개 견적서는 자주 변경되지 않으므로 적절",
      "verificationCriteria": "1. generateMetadata 내 fetch() 호출에 next: { revalidate: 300 } 확인\\n2. 공개 페이지 접속 후 메타데이터 생성 확인\\n3. 동일 shareId로 300초 내 재방문 시 캐시 히트 확인\\n4. 페이지 타이틀, 설명 정상 표시",
      "analysisResult": "Phase 1: 견적서 상세 조회 성능 최적화 (ROADMAP.md 기준)\\\\n\\\\n목표: Lighthouse Performance 74→90+, Notion API 호출 60% 감소, 체감 로딩시간 1초 이내\\\\n\\\\n현황: API 캐싱 부재, 스켈레톤 UI 부분적 구현, Suspense 구조 미흡\\\\n\\\\n전략:\\\\n- ISR 캐싱으로 Notion API 호출 감소\\\\n- 스켈레톤 세분화로 로딩 체감 개선\\\\n- Suspense 경계 최적화\\\\n\\\\n기간: 3일 (2026-02-24 ~ 2026-02-26)"
    },
    {
      "id": "a524e68d-1ed6-4a99-9589-62a4754a2253",
      "name": "Task B-1: 스켈레톤 컴포넌트 신규 생성 (헤더/항목/합계)",
      "description": "현재 InvoiceViewerSkeleton은 공개 페이지에 inline으로 정의되어 있음. 이를 재사용 가능한 컴포넌트들로 분해:\\n\\n신규 파일 3개 생성:\\n1. InvoiceHeaderSkeleton.tsx - 회사명+제목 영역\\n2. InvoiceItemsSkeleton.tsx - 항목 테이블 영역\\n3. InvoiceSummarySkeleton.tsx - 합계 영역\\n\\n각 컴포넌트는 InvoiceViewer 구조에 맞춘 skeleton 구성. 기존 Skeleton 컴포넌트(ui/skeleton)와 shadcn/ui 활용.\\n\\nInvoiceViewerSkeleton.tsx는 기존 코드를 src/components/invoice/로 추출하여 유지.",
      "notes": "- 기존 InvoiceSkeleton.tsx (대시보드용 InvoiceTableSkeleton)는 유지\\n- 신규 스켈레톤들은 src/components/invoice/ 폴더에 집중\\n- 각 스켈레톤의 height/width는 실제 컨텐츠와 유사하게\\n- dark: prefix 클래스 필수 포함 (프로젝트 다크모드 지원)",
      "status": "pending",
      "dependencies": [
        {
          "taskId": "d1593e1a-a176-4f39-9ca7-6a1a9ad77adf"
        },
        {
          "taskId": "f81c4626-2e18-47e9-b53d-5da44adfe8e5"
        }
      ],
      "createdAt": "2026-02-21T02:29:05.218Z",
      "updatedAt": "2026-02-21T02:29:05.218Z",
      "relatedFiles": [
        {
          "path": "src/components/invoice/InvoiceHeaderSkeleton.tsx",
          "type": "CREATE",
          "description": "헤더 영역 스켈레톤 컴포넌트"
        },
        {
          "path": "src/components/invoice/InvoiceItemsSkeleton.tsx",
          "type": "CREATE",
          "description": "항목 테이블 스켈레톤 컴포넌트"
        },
        {
          "path": "src/components/invoice/InvoiceSummarySkeleton.tsx",
          "type": "CREATE",
          "description": "합계 영역 스켈레톤 컴포넌트"
        },
        {
          "path": "src/components/invoice/InvoiceSkeleton.tsx",
          "type": "TO_MODIFY",
          "description": "신규 스켈레톤들 export 추가"
        }
      ],
      "implementationGuide": "1. src/components/invoice/InvoiceHeaderSkeleton.tsx 생성\\n   - 회사 로고 placeholder, 제목 영역\\n   - 실제 layout과 동일하게 grid/flex 구성\\n   - dark: prefix 포함\\n\\n2. src/components/invoice/InvoiceItemsSkeleton.tsx 생성\\n   - 테이블 헤더 skeleton\\n   - 테이블 행 5개 skeleton\\n   - 테이블 푸터 skeleton\\n\\n3. src/components/invoice/InvoiceSummarySkeleton.tsx 생성\\n   - 소계, 구분선, 총액 영역\\n\\n4. 각 컴포넌트는 export const로 정의\\n5. Skeleton import는 ui/skeleton에서\\n6. className은 기존 InvoiceViewer와 일치하도록",
      "verificationCriteria": "1. 3개 신규 스켈레톤 파일이 src/components/invoice/에 생성됨\\n2. 각 파일은 export const로 명명된 컴포넌트 정의\\n3. className에 dark: prefix 포함\\n4. InvoiceSkeleton.tsx에서 import 가능\\n5. TypeScript strict mode 준수",
      "analysisResult": "Phase 1: 견적서 상세 조회 성능 최적화 (ROADMAP.md 기준)\\\\n\\\\n목표: Lighthouse Performance 74→90+, Notion API 호출 60% 감소, 체감 로딩시간 1초 이내\\\\n\\\\n현황: API 캐싱 부재, 스켈레톤 UI 부분적 구현, Suspense 구조 미흡\\\\n\\\\n전략:\\\\n- ISR 캐싱으로 Notion API 호출 감소\\\\n- 스켈레톤 세분화로 로딩 체감 개선\\\\n- Suspense 경계 최적화\\\\n\\\\n기간: 3일 (2026-02-24 ~ 2026-02-26)"
    },
    {
      "id": "25fc5601-4cad-4d01-ac50-6b8e3f0e9d09",
      "name": "Task B-2: 공개 페이지의 InvoiceViewerSkeleton 분리 및 Suspense 최적화",
      "description": "현재 src/app/invoice/[shareId]/page.tsx에 inline으로 정의된 InvoiceViewerSkeleton을 제거하고, Task B-1에서 생성한 스켈레톤들을 import하여 사용.\\n\\n변경:\\n1. 기존 InvoiceViewerSkeleton 함수 제거\\n2. 신규 스켈레톤들 import\\n3. Suspense 구조 유지 (또는 세분화 고려)\\n\\n현재 구조:\\nSuspense fallback={<InvoiceViewerSkeleton />}\\n\\n변경 후:\\nSuspense fallback={<InvoiceViewerSkeleton />} (신규 컴포넌트 사용)",
      "notes": "- 기존 InvoiceViewerSkeleton 함수를 컴포넌트 파일로 분리\\n- Suspense는 현재 1개 경계 유지 (streaming 복잡도 최소화)\\n- 향후 필요시 헤더/항목/합계별 Suspense 분리 가능",
      "status": "pending",
      "dependencies": [
        {
          "taskId": "a524e68d-1ed6-4a99-9589-62a4754a2253"
        }
      ],
      "createdAt": "2026-02-21T02:29:05.218Z",
      "updatedAt": "2026-02-21T02:29:05.218Z",
      "relatedFiles": [
        {
          "path": "src/app/invoice/[shareId]/page.tsx",
          "type": "TO_MODIFY",
          "description": "InvoiceViewerSkeleton 함수 제거, import 추가",
          "lineStart": 71,
          "lineEnd": 150
        },
        {
          "path": "src/components/invoice/InvoiceSkeleton.tsx",
          "type": "REFERENCE",
          "description": "신규 InvoiceViewerSkeleton import"
        }
      ],
      "implementationGuide": "1. src/app/invoice/[shareId]/page.tsx 열기\\n2. InvoiceViewerSkeleton 함수 정의 부분(71~end) 제거\\n3. 상단 import에 추가:\\n   import { InvoiceViewerSkeleton } from '@/components/invoice/InvoiceSkeleton'\\n4. Suspense fallback 유지\\n5. 테스트: 공개 페이지 접속 시 스켈레톤 표시 확인",
      "verificationCriteria": "1. 공개 페이지 코드에서 inline InvoiceViewerSkeleton 함수 제거\\n2. import { InvoiceViewerSkeleton } from '@/components/invoice/InvoiceSkeleton' 추가\\n3. npm run dev 후 공개 페이지 접속\\n4. 로딩 중 스켈레톤 표시 확인\\n5. 로딩 완료 후 InvoiceViewer 정상 렌더링",
      "analysisResult": "Phase 1: 견적서 상세 조회 성능 최적화 (ROADMAP.md 기준)\\\\n\\\\n목표: Lighthouse Performance 74→90+, Notion API 호출 60% 감소, 체감 로딩시간 1초 이내\\\\n\\\\n현황: API 캐싱 부재, 스켈레톤 UI 부분적 구현, Suspense 구조 미흡\\\\n\\\\n전략:\\\\n- ISR 캐싱으로 Notion API 호출 감소\\\\n- 스켈레톤 세분화로 로딩 체감 개선\\\\n- Suspense 경계 최적화\\\\n\\\\n기간: 3일 (2026-02-24 ~ 2026-02-26)"
    },
    {
      "id": "ea3b8a5e-8d46-4310-a94c-06b3e4532642",
      "name": "Task C: 대시보드 페이지 Suspense 구조 검증 및 문서화",
      "description": "현재 대시보드 페이지(/dashboard)의 Suspense 구조가 이미 최적화되어 있는지 검증. DashboardSearchFilter는 Suspense 외부에, InvoiceTableBody는 Suspense 내부에 있는지 확인.\\n\\n현황 분석:\\n- Line 321~323: DashboardSearchFilter (검색/필터) - Suspense 외부\\n- Line 393~395: Suspense { InvoiceTableBody } - 테이블 로딩\\n\\n결론: 이미 최적화되어 있음 ✅\\n\\n작업:\\n1. 코드 검증만 수행\\n2. 주석으로 의도 명확히\\n3. 문서화",
      "notes": "- 검색/필터는 로딩 중에도 즉시 반응 가능\\n- 테이블 데이터만 Suspense로 감싸짐 (UX 개선)\\n- 현재 구조가 최적이므로 변경 불필요\\n- 향후 동적 검색 추가 시 고려 대상",
      "status": "pending",
      "dependencies": [
        {
          "taskId": "d1593e1a-a176-4f39-9ca7-6a1a9ad77adf"
        },
        {
          "taskId": "f81c4626-2e18-47e9-b53d-5da44adfe8e5"
        },
        {
          "taskId": "a524e68d-1ed6-4a99-9589-62a4754a2253"
        }
      ],
      "createdAt": "2026-02-21T02:29:05.218Z",
      "updatedAt": "2026-02-21T02:29:05.218Z",
      "relatedFiles": [
        {
          "path": "src/app/dashboard/page.tsx",
          "type": "REFERENCE",
          "description": "Suspense 구조 검증",
          "lineStart": 321,
          "lineEnd": 395
        }
      ],
      "implementationGuide": "1. src/app/dashboard/page.tsx 열기\\n2. Line 321~323 검색 필터 영역 확인\\n3. Line 393~395 Suspense 경계 확인\\n4. 두 영역이 분리되어 있음을 확인\\n5. 주석 추가:\\n   // DashboardSearchFilter는 Suspense 외부 (검색 필터는 즉시 표시)\\n   // InvoiceTableBody는 Suspense 내부 (데이터 로딩 중 skeleton 표시)\\n6. 변경 없음 (이미 최적화)",
      "verificationCriteria": "1. 대시보드 페이지 코드 리뷰\\n2. DashboardSearchFilter와 Suspense가 분리되어 있음 확인\\n3. 주석 추가로 의도 명확화\\n4. 변경 없음 (이미 최적화)\\n5. Lighthouse 성능 측정 (Task 완료 후)",
      "analysisResult": "Phase 1: 견적서 상세 조회 성능 최적화 (ROADMAP.md 기준)\\\\n\\\\n목표: Lighthouse Performance 74→90+, Notion API 호출 60% 감소, 체감 로딩시간 1초 이내\\\\n\\\\n현황: API 캐싱 부재, 스켈레톤 UI 부분적 구현, Suspense 구조 미흡\\\\n\\\\n전략:\\\\n- ISR 캐싱으로 Notion API 호출 감소\\\\n- 스켈레톤 세분화로 로딩 체감 개선\\\\n- Suspense 경계 최적화\\\\n\\\\n기간: 3일 (2026-02-24 ~ 2026-02-26)"
    }
  ]
}