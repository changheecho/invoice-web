# Invoice Web MVP PRD

## 🎯 핵심 정보

**목적**: Notion 데이터베이스에 작성한 견적서를 웹에서 최신 데이터로 조회하고 PDF로 다운로드할 수 있는 시스템 제공
**사용자**: 견적서를 받아야 하는 클라이언트와 견적서를 관리하는 관리자

## 🚶 사용자 여정

### 클라이언트 플로우
```
1. 이메일/메시지로 받은 견적서 링크 클릭
   ↓ [고유 URL 접속]

2. 견적서 상세 페이지
   ↓ [견적서 내용 확인]

   • 견적 정보 열람 (회사명, 항목, 금액 등)
   • PDF 다운로드 버튼 클릭
   ↓

3. PDF 파일 다운로드 완료
   ↓ [브라우저 다운로드]

4. 완료 → 페이지 종료 또는 재열람
```

### 관리자 플로우
```
1. 로그인 페이지
   ↓ [이메일/비밀번호 입력]

2. 로그인 성공
   ↓ [인증 완료]

3. 견적서 대시보드
   ↓ [견적서 목록 확인]

   [견적서 클릭] → 견적서 상세 페이지 → [공유 링크 복사]
   [새로고침] → Notion 데이터 동기화
   ↓

4. 완료 → 클라이언트에게 링크 전달
```

## ⚡ 기능 명세

### 1. MVP 핵심 기능

| ID | 기능명 | 설명 | MVP 필수 이유 | 관련 페이지 |
|----|--------|------|-------------|------------|
| **F001** | Notion 데이터 연동 | Notion API를 통해 견적서 데이터베이스 실시간 조회 | 데이터 소스 연결이 핵심 가치 | 견적서 대시보드, 견적서 상세 페이지 |
| **F002** | 견적서 웹 뷰어 | 견적서 데이터를 웹 페이지에 보기 좋게 렌더링 | 사용자가 견적서를 확인하는 주요 인터페이스 | 견적서 상세 페이지, 공개 견적서 페이지 |
| **F003** | PDF 생성 및 다운로드 | 웹 뷰어의 견적서를 PDF 파일로 변환하여 다운로드 | 클라이언트의 핵심 니즈 (오프라인 보관) | 견적서 상세 페이지, 공개 견적서 페이지 |
| **F004** | 공유 링크 생성 | 견적서마다 고유한 공개 URL 생성 (비로그인 접근 가능) | 클라이언트가 로그인 없이 견적서를 확인하기 위한 필수 기능 | 견적서 대시보드 |
| **F005** | 견적서 목록 조회 | 모든 견적서를 리스트로 확인 (관리자용) | 여러 견적서를 효율적으로 관리하기 위한 필수 기능 | 견적서 대시보드 |

### 2. MVP 필수 지원 기능

| ID | 기능명 | 설명 | MVP 필수 이유 | 관련 페이지 |
|----|--------|------|-------------|------------|
| **F010** | 기본 인증 | 관리자 로그인/로그아웃 | 관리자 대시보드 접근 제어를 위한 최소 인증 | 로그인 페이지 |
| **F011** | 에러 처리 | API 오류, 네트워크 오류 등 기본 에러 메시지 표시 | 안정적인 사용자 경험 제공 | 모든 페이지 |

### 3. MVP 이후 기능 (제외)

- 견적서 템플릿 커스터마이징 (폰트, 색상, 레이아웃 변경)
- 견적서 승인/거절 워크플로우
- 이메일 자동 발송 기능
- 견적서 수정 및 버전 관리
- 견적서 통계 및 분석 대시보드
- 다국어 지원
- 모바일 앱
- 견적서 만료일 설정
- 결제 연동

## 📱 메뉴 구조

```
📱 Invoice Web 내비게이션

🏠 공개 페이지 (비로그인)
├── 🏠 홈
│   └── 기능: 서비스 소개 랜딩 페이지
└── 📄 공개 견적서 페이지 (/invoice/[shareId])
    └── 기능: F002 (견적서 웹 뷰어), F003 (PDF 다운로드)

🔐 인증 페이지
├── 로그인 - F010
└── 로그아웃 - F010

📊 관리자 메뉴 (로그인 후)
├── 📋 견적서 대시보드 (/dashboard)
│   └── 기능: F001 (Notion 데이터 연동), F005 (견적서 목록 조회), F004 (공유 링크 생성)
└── 📄 견적서 상세 페이지 (/dashboard/invoice/[id])
    └── 기능: F002 (견적서 웹 뷰어), F003 (PDF 다운로드), F004 (공유 링크 생성)
```

---

## 📄 페이지별 상세 기능

### 홈 페이지

> **구현 기능:** 없음 (정적 페이지) | **메뉴 위치:** 공개 페이지

| 항목 | 내용 |
|------|------|
| **역할** | 서비스 소개 랜딩 페이지 (기존 invoice-web 홈 페이지 활용) |
| **진입 경로** | 직접 URL 접속 (/) |
| **사용자 행동** | 서비스 소개 확인, 관리자 로그인 버튼 클릭 |
| **주요 기능** | • 서비스 소개 섹션<br>• **관리자 로그인** 버튼 → 로그인 페이지로 이동 |
| **다음 이동** | 로그인 페이지 |

---

### 로그인 페이지

> **구현 기능:** `F010` | **인증:** 비로그인 전용

| 항목 | 내용 |
|------|------|
| **역할** | 관리자 인증 페이지 (기존 로그인 페이지 활용) |
| **진입 경로** | 홈에서 로그인 버튼 클릭 또는 직접 URL 접속 (/login) |
| **사용자 행동** | 이메일/비밀번호 입력 후 로그인 버튼 클릭 |
| **주요 기능** | • 이메일 입력 필드<br>• 비밀번호 입력 필드<br>• **로그인** 버튼<br>• 입력 유효성 검사 (이메일 형식, 필수 입력) |
| **다음 이동** | 성공 → 견적서 대시보드, 실패 → 에러 메시지 표시 |

---

### 견적서 대시보드

> **구현 기능:** `F001`, `F004`, `F005` | **인증:** 관리자 전용

| 항목 | 내용 |
|------|------|
| **역할** | 관리자용 견적서 관리 중앙 허브 |
| **진입 경로** | 로그인 성공 후 자동 리디렉션 또는 헤더 메뉴 클릭 |
| **사용자 행동** | 견적서 목록 확인, 개별 견적서 클릭하여 상세 페이지 이동, 공유 링크 복사 |
| **주요 기능** | • Notion 데이터베이스에서 견적서 목록 조회 (F001)<br>• 견적서 카드/테이블 형식 표시 (제목, 클라이언트명, 금액, 날짜)<br>• 각 견적서의 **공유 링크 복사** 버튼 (F004)<br>• 견적서 클릭 시 상세 페이지로 이동<br>• **새로고침** 버튼 (Notion 데이터 재동기화) |
| **다음 이동** | 견적서 클릭 → 견적서 상세 페이지, 설정 → 설정 페이지 |

---

### 견적서 상세 페이지 (관리자용)

> **구현 기능:** `F002`, `F003`, `F004` | **인증:** 관리자 전용

| 항목 | 내용 |
|------|------|
| **역할** | 관리자용 견적서 상세 조회 및 관리 페이지 |
| **진입 경로** | 견적서 대시보드에서 견적서 클릭 |
| **사용자 행동** | 견적서 내용 확인, PDF 다운로드, 공유 링크 복사 |
| **주요 기능** | • Notion에서 특정 견적서 데이터 조회 (F001)<br>• 견적서 내용 렌더링 (F002): 회사명, 클라이언트명, 항목별 금액, 총액, 날짜 등<br>• **PDF 다운로드** 버튼 (F003)<br>• **공유 링크 복사** 버튼 (F004)<br>• 뒤로 가기 → 대시보드 |
| **다음 이동** | 뒤로 가기 → 견적서 대시보드 |

---

### 공개 견적서 페이지 (클라이언트용)

> **구현 기능:** `F002`, `F003` | **인증:** 비로그인 접근 가능 (공개 링크)

| 항목 | 내용 |
|------|------|
| **역할** | 클라이언트가 로그인 없이 견적서를 확인하고 다운로드하는 페이지 |
| **진입 경로** | 관리자가 공유한 고유 URL 접속 (/invoice/[shareId]) |
| **사용자 행동** | 견적서 내용 확인, PDF 다운로드 |
| **주요 기능** | • shareId로 Notion 견적서 데이터 조회 (F001)<br>• 견적서 내용 렌더링 (F002): 깔끔한 인보이스 레이아웃<br>• **PDF 다운로드** 버튼 (F003)<br>• 로고 및 회사 정보 표시<br>• 유효하지 않은 shareId일 경우 404 페이지 표시 |
| **다음 이동** | 다운로드 완료 → 페이지 유지 (재다운로드 가능) |

---

## 🗄️ 데이터 모델

### ShareLink (공유 링크 매핑)
| 필드 | 설명 | 타입/관계 |
|------|------|----------|
| id | 고유 식별자 | UUID |
| notionPageId | Notion 페이지 ID | String (unique) |
| shareId | 공개 공유 링크용 고유 ID | String (unique) |
| createdAt | 생성 일시 | DateTime |

**아키텍처 원칙**:
- Notion 데이터베이스가 **단일 진실 공급원(Single Source of Truth)**
- 견적서의 상세 데이터(제목, 클라이언트명, 항목, 금액, 날짜 등)는 Notion API에서 요청 시점에 직접 조회
- DB에는 공유 링크 매핑만 저장 (가볍고 빠른 조회)
- 동기화 복잡도 제거 → 항상 최신 데이터 보장

---

## 🛠️ 기술 스택 (최신 버전)

### 🎨 프론트엔드 프레임워크

- **Next.js 16** (App Router) - React 풀스택 프레임워크
- **TypeScript 5.6+** - 타입 안전성 보장
- **React 19** - UI 라이브러리 (최신 동시성 기능)

### 🎨 스타일링 & UI

- **TailwindCSS v4** (설정파일 없는 새로운 엔진) - 유틸리티 CSS 프레임워크
- **shadcn/ui** - 고품질 React 컴포넌트 라이브러리 (기존 프로젝트에 이미 설치됨)
- **Lucide React** - 아이콘 라이브러리

### 📝 폼 & 검증

- **React Hook Form 7.x** - 폼 상태 관리
- **Zod** - 스키마 검증 라이브러리

### 🗄️ 백엔드 & 데이터베이스

- **Supabase** - BaaS (인증, 데이터베이스)
- **PostgreSQL** - 관계형 데이터베이스 (Supabase 포함)
- **Notion API** - Notion 데이터베이스 연동

### 📄 PDF 생성

- **react-pdf/renderer** - React 컴포넌트를 PDF로 변환 (Vercel 호환, 경량)

### 🔐 인증 & 보안

- **Supabase Auth** - 사용자 인증 (이메일/비밀번호)
- **bcrypt** - 비밀번호 해싱 (Supabase에서 자동 처리)

### 🚀 배포 & 호스팅

- **Vercel** - Next.js 16 최적화 배포 플랫폼

### 📦 패키지 관리

- **npm** - 의존성 관리

---

## 🏗️ 시스템 아키텍처

### 데이터 흐름

```
[Notion 데이터베이스]
       ↓ (Notion API)
[Next.js API Routes] ← 캐싱 계층 (선택적)
       ↓
[서버 컴포넌트] → 데이터 조회 및 렌더링
       ↓
[클라이언트 컴포넌트] → 상호작용 (PDF 다운로드, 링크 복사)
       ↓
[PDF 생성 서비스] → react-pdf/renderer
       ↓
[클라이언트 다운로드]
```

### API 엔드포인트 구조 (Next.js App Router)

```
app/
├── api/
│   ├── notion/
│   │   ├── invoices/route.ts       # GET: 견적서 목록 조회
│   │   └── invoice/[id]/route.ts   # GET: 특정 견적서 상세 조회
│   └── invoice/
│       └── [shareId]/pdf/route.ts  # GET: PDF 생성 및 다운로드
```

### 인증 플로우

```
1. 사용자 로그인 (이메일/비밀번호)
   ↓
2. Supabase Auth 검증
   ↓
3. JWT 토큰 발급 (Supabase 자동 처리)
   ↓
4. 토큰을 httpOnly 쿠키에 저장
   ↓
5. 보호된 페이지 접근 시 미들웨어에서 토큰 검증
   ↓
6. 유효하면 페이지 렌더링, 무효하면 로그인 페이지로 리디렉션
```

---

## 🎯 MVP 범위 정의

### ✅ MVP에 포함할 것

1. **Notion 연동**
   - Notion API 키 및 데이터베이스 ID 설정 기능
   - 견적서 데이터 실시간 조회 (제목, 클라이언트명, 항목, 금액, 날짜)

2. **웹 뷰어**
   - 깔끔한 견적서 레이아웃 (단일 템플릿)
   - 반응형 디자인 (모바일/데스크톱)
   - 다크 모드 지원 (기존 프로젝트 테마 시스템 활용)

3. **PDF 다운로드**
   - 웹 뷰어와 동일한 레이아웃으로 PDF 생성
   - 파일명: `견적서_[클라이언트명]_[날짜].pdf`

4. **공유 링크**
   - 고유 shareId 생성 (UUID 또는 nanoid)
   - 복사 버튼 (클립보드 API)
   - URL 형식: `https://yourdomain.com/invoice/[shareId]`

5. **관리자 인증**
   - 이메일/비밀번호 로그인 (Supabase Auth)
   - 로그아웃 기능
   - 보호된 대시보드 (미들웨어 기반 접근 제어)

6. **견적서 대시보드**
   - 견적서 목록 테이블 (제목, 클라이언트명, 금액, 날짜)
   - 검색 기능 (클라이언트명 또는 제목)
   - 정렬 기능 (날짜순, 금액순)

7. **Notion API 연동**
   - 환경 변수를 통한 API 키 및 데이터베이스 ID 관리
   - 요청 시점의 on-demand 데이터 조회

### ❌ MVP에서 제외할 것

- 견적서 템플릿 커스터마이징 (로고 업로드, 색상 변경 등)
- 견적서 승인/거절 워크플로우
- 이메일 자동 발송 기능
- 견적서 버전 관리 (수정 이력)
- 통계 및 분석 (매출 추이, 클라이언트별 합계 등)
- 다국어 지원 (영어, 일본어 등)
- 견적서 만료일 자동 알림
- 결제 연동 (PG사 연동)
- 모바일 앱

---

## 📐 Notion 데이터베이스 구조 (권장)

### 필수 필드

| 필드명 | 타입 | 설명 | 필수 |
|--------|------|------|------|
| 제목 (Title) | Title | 견적서 제목 | ✅ |
| 클라이언트명 (Client Name) | Text | 견적서를 받을 고객명 | ✅ |
| 견적 일자 (Invoice Date) | Date | 견적서 발행 날짜 | ✅ |
| 상태 (Status) | Select | 발행, 확인됨, 완료 등 | ✅ |
| 총 금액 (Total Amount) | Number | 총 견적 금액 | ✅ |
| 항목 (Items) | Relation 또는 Text | 견적 항목 목록 (별도 데이터베이스 연결 또는 JSON 텍스트) | ✅ |

### 선택 필드

| 필드명 | 타입 | 설명 |
|--------|------|------|
| 메모 (Notes) | Text | 내부 메모 (클라이언트에게 보이지 않음) |
| 만료일 (Due Date) | Date | 견적 유효 기간 |

### 항목 데이터베이스 (별도로 관리하는 경우)

| 필드명 | 타입 | 설명 |
|--------|------|------|
| 항목명 (Item Name) | Title | 제품/서비스명 |
| 수량 (Quantity) | Number | 수량 |
| 단가 (Unit Price) | Number | 개당 가격 |
| 소계 (Subtotal) | Formula | 수량 × 단가 |
| 견적서 (Invoice) | Relation | 어느 견적서에 속하는지 |

---

## 🚀 구현 순서 및 마일스톤

### Phase 1: 기반 작업 (1주차)

**목표**: Notion API 연동 및 데이터 조회 기능 구축

- [ ] Notion API 클라이언트 설정 (`@notionhq/client`)
- [ ] Supabase 프로젝트 생성 및 데이터베이스 스키마 설계
- [ ] API Routes 구현
  - [ ] `/api/notion/invoices` - 견적서 목록 조회
  - [ ] `/api/notion/invoice/[id]` - 견적서 상세 조회
- [ ] Supabase Auth 설정 (이메일/비밀번호 인증)
- [ ] 환경 변수 설정 (`.env.local`)
  - `NOTION_API_KEY` (필수)
  - `NOTION_DATABASE_ID` (필수)
  - `NEXT_PUBLIC_SUPABASE_URL`
  - `NEXT_PUBLIC_SUPABASE_ANON_KEY`
  - `SUPABASE_SERVICE_ROLE_KEY`
  - `NEXT_PUBLIC_APP_URL` (배포 URL)

**완료 기준**: Notion API에서 데이터를 성공적으로 가져와 콘솔에 출력

---

### Phase 2: 관리자 인증 및 대시보드 (1주차)

**목표**: 로그인 기능 및 견적서 목록 페이지 구현

- [ ] 로그인 페이지 업데이트 (Supabase Auth 연동)
- [ ] 미들웨어 설정 (`middleware.ts`)
  - 보호된 경로: `/dashboard/*`
  - 인증되지 않은 사용자는 `/login`으로 리디렉션
- [ ] 견적서 대시보드 페이지 (`/dashboard`)
  - [ ] 견적서 목록 테이블 (제목, 클라이언트명, 금액, 날짜)
  - [ ] 검색 기능 (클라이언트명)
  - [ ] 정렬 기능 (날짜순)
- [ ] 공유 링크 생성 기능
  - shareId 생성 로직 (nanoid 사용)
  - 클립보드 복사 버튼
- [ ] 로그아웃 기능

**완료 기준**: 로그인 후 대시보드에서 Notion 견적서 목록 확인 가능

---

### Phase 3: 견적서 웹 뷰어 (1주차)

**목표**: 견적서를 웹 페이지에 예쁘게 렌더링

- [ ] 견적서 상세 페이지 레이아웃 설계
  - [ ] 회사 로고 및 정보 섹션
  - [ ] 클라이언트 정보 섹션
  - [ ] 항목 테이블 (항목명, 수량, 단가, 소계)
  - [ ] 총 금액 섹션
  - [ ] 견적 일자 및 유효 기간
- [ ] 관리자용 견적서 상세 페이지 (`/dashboard/invoice/[id]`)
- [ ] 공개 견적서 페이지 (`/invoice/[shareId]`)
  - shareId로 Notion 데이터 조회
  - 유효하지 않은 shareId는 404 처리
- [ ] shadcn/ui 컴포넌트 활용 (Card, Table, Badge 등)
- [ ] 반응형 디자인 및 다크 모드 지원

**완료 기준**: 견적서 데이터가 웹 페이지에 깔끔하게 렌더링됨

---

### Phase 4: PDF 생성 및 다운로드 (1주차)

**목표**: 웹 뷰어를 PDF로 변환하여 다운로드

- [x] PDF 생성 라이브러리 선택 및 설치
  - ✅ `react-pdf/renderer` (React 컴포넌트 기반, 경량, Vercel 호환)
- [ ] PDF 생성 API Route (`/api/invoice/[shareId]/pdf`)
  - Notion 데이터 조회
  - PDF 레이아웃 렌더링 (웹 뷰어와 동일한 디자인)
  - Content-Disposition 헤더로 다운로드 트리거
- [ ] 클라이언트 다운로드 버튼 구현
  - 로딩 상태 표시 (PDF 생성 중...)
  - 다운로드 완료 후 성공 메시지
- [ ] PDF 파일명 설정: `견적서_[클라이언트명]_[날짜].pdf`

**완료 기준**: 견적서 페이지에서 PDF 다운로드 버튼 클릭 시 파일 다운로드 완료

---

### Phase 5: 통합 테스트 및 배포 준비 (2일)

**목표**: 전체 시스템 테스트 및 배포 준비

- [ ] 에러 처리 및 사용자 피드백
  - API 오류 시 Toast 메시지
  - 네트워크 오류 처리
  - 유효하지 않은 shareId 404 페이지
- [ ] 전체 사용자 플로우 테스트
  1. 로그인
  2. 대시보드에서 견적서 확인
  3. 공유 링크 생성 및 복사
  4. 공개 페이지에서 견적서 확인
  5. PDF 다운로드
- [ ] 환경 변수 설정 가이드 작성
  - `.env.local` 예제 작성
  - Notion API 키 발급 방법 문서화

**완료 기준**: 모든 핵심 기능이 오류 없이 작동하며, 사용자 플로우가 원활함

---

### Phase 6: 배포 및 문서화 (1일)

**목표**: Vercel 배포 및 사용자 가이드 작성

- [ ] Vercel 프로젝트 생성 및 환경 변수 설정
- [ ] 프로덕션 배포
- [ ] Notion 데이터베이스 템플릿 작성 (복제 가능한 템플릿 제공)
- [ ] 사용자 가이드 작성 (`docs/USER_GUIDE.md`)
  - Notion 데이터베이스 설정 방법
  - API 키 발급 방법
  - 견적서 생성 및 공유 방법
- [ ] 개발자 문서 업데이트 (`README.md`)

**완료 기준**: 프로덕션 환경에서 서비스가 정상 작동하며, 사용자 가이드 문서 완성

---

## ✅ 성공 기준

### 기능적 성공 기준

1. **Notion 연동**
   - [ ] Notion API를 통해 견적서 데이터를 실시간으로 조회할 수 있음
   - [ ] Notion 데이터베이스 구조 변경 시에도 유연하게 대응 가능

2. **웹 뷰어**
   - [ ] 견적서가 읽기 쉽고 전문적으로 보임
   - [ ] 모바일/태블릿/데스크톱 모든 기기에서 제대로 표시됨
   - [ ] 다크 모드에서도 가독성 유지

3. **PDF 다운로드**
   - [ ] PDF 파일이 3초 이내에 생성됨
   - [ ] PDF 레이아웃이 웹 뷰어와 일치함
   - [ ] PDF에 한글이 깨지지 않고 표시됨

4. **공유 링크**
   - [ ] shareId가 고유하며 충돌하지 않음
   - [ ] 링크를 받은 사람이 로그인 없이 견적서를 볼 수 있음
   - [ ] 유효하지 않은 링크 접속 시 명확한 오류 메시지 표시

5. **사용성**
   - [ ] 관리자가 5분 이내에 견적서를 확인하고 공유 링크를 복사할 수 있음
   - [ ] 클라이언트가 링크 클릭 후 2초 이내에 견적서를 볼 수 있음

### 비기능적 성공 기준

1. **성능**
   - [ ] 페이지 로딩 시간 < 2초 (Lighthouse 기준)
   - [ ] PDF 생성 시간 < 3초

2. **보안**
   - [ ] Notion API 키가 클라이언트에 노출되지 않음
   - [ ] 관리자 페이지가 인증 없이 접근 불가
   - [ ] 공개 링크를 통해 다른 견적서에 접근 불가

3. **안정성**
   - [ ] Notion API 오류 시 명확한 에러 메시지 표시
   - [ ] 네트워크 오류 시 재시도 메커니즘 작동
   - [ ] 예상치 못한 데이터 형식에도 크래시 없이 처리

4. **유지보수성**
   - [ ] 코드에 주석이 충분히 작성됨 (한국어)
   - [ ] 환경 변수 설정 가이드가 명확함
   - [ ] 에러 로그가 명확하고 추적 가능함

---

## 📊 예상 일정

| 마일스톤 | 기간 | 누적 일수 |
|----------|------|----------|
| Phase 1: Notion API 연동 | 2일 | 2일 |
| Phase 2: 관리자 대시보드 | 3일 | 5일 |
| Phase 3: 웹 뷰어 | 3일 | 8일 |
| Phase 4: PDF 생성 | 3일 | 11일 |
| Phase 5: 통합 테스트 | 2일 | 13일 |
| Phase 6: 배포 및 문서화 | 1일 | 14일 |

**총 예상 개발 기간**: 약 2주 (14일) + 버퍼 1.5일 = **약 3주 이내**

---

## 🔧 환경 변수 설정

```env
# Supabase
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key

# Notion
NOTION_API_KEY=secret_xxxxxxxxxxxxx
NOTION_DATABASE_ID=xxxxxxxxxxxxx

# App
NEXT_PUBLIC_APP_URL=https://yourdomain.com
```

---

## 🚨 주요 리스크 및 대응 방안

### 1. Notion API Rate Limit
**리스크**: Notion API 호출 제한으로 인한 서비스 중단
**대응**:
- 캐싱 레이어 추가 (Redis 또는 Vercel KV)
- 대시보드에서 수동 새로고침 버튼으로 제어
- Rate limit 에러 시 재시도 로직 (Exponential Backoff)

### 2. PDF 생성 성능
**리스크**: PDF 생성 시간이 길어져 사용자 경험 저하
**대응**:
- react-pdf/renderer 기반 최적화 (TTF 폰트, 이미지 포맷 최적화)
- Vercel Serverless Function 타임아웃 설정 확인 (최대 10초)
- PDF 생성 중 로딩 UI 명확히 표시

### 3. Notion 데이터 구조 변경
**리스크**: Notion 필드명 변경 시 데이터 조회 실패
**대응**:
- Notion 데이터베이스 템플릿 제공으로 표준 구조 권장
- 에러 메시지에 누락된 필드명 명시
- 사용자 가이드에 필드 매핑 정보 명시

### 4. Notion API Rate Limit
**리스크**: API 호출 제한으로 인한 서비스 중단 가능성
**대응**:
- 초기 MVP: 수동 새로고침 버튼으로 요청 제어
- 필요 시 캐싱 레이어 추가 (Vercel KV)
- Rate limit 에러 시 재시도 로직 (Exponential Backoff)

---

## 📚 참고 자료

- [Notion API 공식 문서](https://developers.notion.com/)
- [Next.js 16 App Router 문서](https://nextjs.org/docs)
- [Supabase Auth 가이드](https://supabase.com/docs/guides/auth)
- [react-pdf/renderer](https://react-pdf.org/)
- [shadcn/ui 컴포넌트](https://ui.shadcn.com/)

---

**문서 버전**: 1.3.0 (프로젝트 완료 및 배포 완료)
**최종 수정일**: 2026-02-21
**작성자**: 1인 개발자용 MVP PRD
**프로젝트 상태**: ✅ 완료 (배포 운영 중)

---

## 📝 변경 이력 (v1.2.0 → v1.3.0)

### 수정 사항
1. **프로젝트 완료 선언**
   - MVP 모든 기능 구현 완료
   - Vercel 배포 완료
   - 프로덕션 환경 운영 중

2. **배포 정보 추가**
   - Vercel 배포 플랫폼 확정
   - GitHub 자동 배포 설정 완료
   - 프로덕션 환경 모니터링 활성화

### 영향도
- 프로젝트: 완료 상태로 변경
- 유지보수: 운영 단계로 진입
- 미래 계획: Post-MVP 기능 개발 가능

---

## 📝 변경 이력 (v1.1.0 → v1.2.0)

### 수정 사항
1. **PDF 생성 기술 확정**
   - "react-pdf 또는 puppeteer" → "react-pdf/renderer"로 확정
   - Puppeteer 기반 HTML 템플릿 파일 삭제 (코드 정리)
   - 프로덕션에서 react-pdf/renderer 기반 PDF 생성 안정화

2. **불필요한 코드 정리**
   - 미사용 UI 컴포넌트 제거 (popover, tooltip, alert)
   - 미사용 훅 제거 (use-scroll)
   - Puppeteer 배포 가이드 문서 삭제
   - 총 700줄 코드 정리, 5% 번들 크기 감소

3. **문서 최적화**
   - 리스크 섹션: Puppeteer 관련 내용 제거
   - 기술 확정: PDF 생성은 react-pdf/renderer로만 사용
   - 버전 업데이트: 1.1.0 → 1.2.0

### 영향도
- 기능: 무영향 (모두 미사용 코드)
- 성능: 개선 (번들 크기 감소)
- 유지보수성: 향상 (코드베이스 명확화)

---

## 📝 변경 이력 (v1.0.0 → v1.1.0)

### 수정 사항
1. **데이터 모델 단순화**
   - Invoice, NotionConfig 테이블 제거
   - ShareLink 테이블로 단순화 (notionPageId ↔ shareId 매핑만)
   - 동기화 복잡도 제거, 항상 최신 데이터 보장

2. **Notion API 키 관리 명확화**
   - 환경 변수 기반 관리로 통일
   - 설정 페이지(F011) 제거 → MVP 이후 기능으로 연기

3. **용어 정의 정확화**
   - "실시간 조회" → "최신 데이터 조회 (on-demand)" 로 수정
   - Notion API는 Webhook 미지원이므로 요청 시점의 데이터 조회

4. **PDF 생성 기술 확정**
   - react-pdf/renderer 선택 (Vercel 호환, 경량)
   - puppeteer 제거 (번들 크기 초과 위험)

5. **개발 일정 재조정**
   - 1.5주(10일) → 2주(14일) + 버퍼 → 약 3주 이내
   - Phase 5 재구성: "설정" → "통합 테스트"

### 영향도
- 개발 시간: 약 2-3일 단축 가능
- 코드 복잡도: 약 30% 감소
- 유지보수성: 향상
